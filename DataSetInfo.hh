#include <iostream>
#include <map>
#include <cmath>
#include "glob.h"

#include "GATDataSet.hh"

using namespace std;

// ======================================================================
// NOTE: There is only one difference between this file and the 0nbb version:
//       Runs 19832 and 19833 were removed, since their built data
//       didn't match their gatified data as of 2 Oct. 2017.
//
// NOTE 2:  PSA parameters have been moved to "psaInfo.hh" but are otherwise identical.
//
// ======================================================================

// ======================================================================
// Contents:
//
// FindDataSet - Returns the DS number of a given run.
// GetDataSetSequences - Returns a map of all the sub-ranges in a DS.
// GetDSRunAndStartTimes - Start time and run time of each DS
// LoadDataSet - Contains run ranges for all DS's, updates a GATDataSet.
// LoadDetectorList - Gives a list of the detector names for each module.
// GetTotalActiveMass - Total active mass for each dataset.
//                      This could be calculated instead of hardcoded in the future.
// LoadActiveMasses - Returns a map of all active masses.
// LoadActiveMassUncertainties - Returns a map of all active mass uncertainties.
// LoadBadDetectorMap - Returns a map of bad (i.e. not biased, unusuable) detectors.
// LoadVetoDetectorMap - Returns a map of veto-only detectors.
// GetChannelSelectionPath - Returns a string with the path to the highest
//                          version of the channel selection files.
// LoadEnrNatMap - quick way to tell if a given detID is enriched (1) or natural (0).
// CheckModule - Given a detector ID, look up which module it lives in.
// GetVetoActiveMass - Modifies total mass to not include veto-only detectors.
// LoadDS4MuonList - Static muon list for DS-4, calculated manually
//                   by $GATDIR/mjd-veto/skim-veto.cc
// GetLNRunCoverage - Given a run and DS number, verify that this run is covered
//                    by the most recent LN Fill Tag.
// LoadLNFillTimes1 - Returns a vector of M1 LN fills.
// LoadLNFillTimes2 - Returns a vector of M2 LN fills.
//
// ======================================================================

// When LoadDataSet is updated, this must be updated as well.
int FindDataSet(int run)
{
  if (run >= 2361 && run <= 7635)   return 0;
  if (run >= 9034 && run <= 14502)  return 1;
  if (run >= 14503 && run <= 15892) return 2;
  if (run >= 16797 && run <= 18351) return 3;
  if (run >= 60000791 && run <= 60001926) return 4;
  if (run >= 18623 && run <= 25671) return 5;
  if (run >= 25672 && run <= 100000) return 6;
  cout << "Error: Can't find a dataset for run " << run << endl;
  return -1;
}


// When LoadDataSet is updated, this must be updated as well.
int GetDataSetSequences(int dsNum)
{
  map<int,int> dsMap = {{0,75},{1,51},{2,7},{3,24},{4,18},{5,112},{6,5}};
  return dsMap[dsNum];
}


void GetDSRunAndStartTimes(int dsNum, double &runTime_s, double &startTime0)
{
  // Values found using the GATDataSet method option in $GATDIR/Apps/ds_livetime.cc

  runTime_s = 0, startTime0 = 0;
  if(dsNum == 0) {
    runTime_s = 3967363;
    startTime0 = 1435687000; // start time of run 2580
  }
  else if(dsNum == 1) {
    runTime_s = 5077520; //was 4728790; before blinding
    startTime0 = 1452643100; // start time of run 9422
  }
  else if (dsNum == 2) {
    runTime_s =  827346;
    startTime0 = 1464956900; // start time of run 14775
  }
  else if(dsNum == 3) {
    runTime_s = 2581517;//1549710;
    startTime0 = 1472169600; // start time of run 16797
  }
  else if(dsNum == 4) {
    // runTime_s = 2047670;//1460390;
    runTime_s = 1654247;
    startTime0 = 1472169600; // start time of run 60000802
  }
  else if (dsNum == 5) {
    runTime_s = 10461454;
    startTime0 = 1476396800; // start time of run 18623
  }
  else if (dsNum == 6) {
    runTime_s = 654631;
    startTime0 = 1494535900; // start time of run 25704
  }
  else cout << "Error: GetDSRunAndStartTimes(): Unknown dataset number: " << dsNum << endl;
}


map<int, vector<int> > LoadDataSet(GATDataSet& ds, int dsNum, int subNum=-1)
{
  map<int, vector<int> > runRanges;

  // DS0 (P3JDY)
  if (dsNum == 0) runRanges = {
    // format: { {subRange, {range1_lo,range1_hi, range2_lo,range2_hi ...}} }
    {0, {2580,2580, 2582,2612}},
    {1, {2614,2629, 2644,2649, 2658,2673}},
    {2, {2689,2715}},
    {3, {2717,2750}},
    {4, {2751,2757, 2759,2784}},
    {5, {2785,2820}},
    {6, {2821,2855}},
    {7, {2856,2890}},
    {8, {2891,2907, 2909,2920}},
    {9, {3137,3166}},
    {10, {3167,3196}},
    {11, {3197,3199, 3201,3226}},
    {12, {3227,3256}},
    {13, {3257,3271, 3293,3310}},
    {14, {3311,3340}},
    {15, {3341,3370}},
    {16, {3371,3372, 3374,3400}},
    {17, {3401,3424, 3426,3428, 3431,3432}},
    {18, {3461,3462, 3464,3500}},
    {19, {3501,3530}},
    {20, {3531,3560}},
    {21, {3561,3580, 3596,3610}},
    {22, {3611,3644}},
    {23, {4034,4035, 4038,4039, 4045,4074}},
    {24, {4075,4104}},
    {25, {4105,4133}},
    {26, {4239,4245, 4248,4254, 4256,4268}},
    {27, {4270,4271, 4273,4283}},
    {28, {4285,4311}},
    {29, {4313,4318, 4320,4320, 4322,4326, 4328,4336}},
    {30, {4338,4361}},
    {31, {4363,4382}},
    {32, {4384,4401}},
    {33, {4403,4409, 4411,4427}},
    {34, {4436,4454}},
    {35, {4457,4457, 4459,4489}},
    {36, {4491,4493, 4573,4573, 4575,4590}},
    {37, {4591,4609, 4611,4624}},
    {38, {4625,4635, 4637,4654}},
    {39, {4655,4684}},
    {40, {4685,4714}},
    {41, {4715,4744}},
    {42, {4745,4777}},
    {43, {4789,4797, 4800,4823, 4825,4831}},
    {44, {4854,4872}},
    {45, {4874,4883, 4885,4907}},
    {46, {4938,4945, 4947,4959}},
    {47, {4962,4962, 4964,4964, 4966,4968, 4970,4980}},
    {48, {5007,5038}},
    {49, {5040,5053, 5055,5056, 5058,5061}},
    {50, {5090,5117}},
    {51, {5125,5154}},
    {52, {5155,5184}},
    {53, {5185,5224}},
    {54, {5225,5251}},
    {55, {5277,5284, 5286,5300}},
    {56, {5301,5330}},
    {57, {5372,5376, 5378,5392, 5405,5414}},
    {58, {5449,5458, 5461,5479}},
    {59, {5480,5496, 5498,5501, 5525,5526, 5531,5534}},
    {60, {5555,5589}},
    {61, {5591,5608}},
    {62, {5610,5639}},
    {63, {5640,5669}},
    {64, {5670,5699}},
    {65, {5701,5729}},
    {66, {5730,5751, 5753,5764}},
    {67, {5766,5795}},
    {68, {5796,5822}},
    {69, {5826,5850}},
    {70, {5889,5890, 5894,5895}},
    {71, {6553,6575, 6577,6577, 6775,6775}},
    {72, {6776,6782, 6784,6809}},
    {73, {6811,6830}},
    {74, {6834,6853}},
    {75, {6887,6903, 6957,6963}}
    };

  // DS1 (P3KJR)
  else if (dsNum == 1) runRanges = {
    {0, {9422,9440}},
    {1, {9471,9487, 9492, 9492}},
    {2, {9536,9565}},
    {3, {9638,9647, 9650, 9668}},
    {4, {9674,9676, 9678, 9678, 9711, 9727}},
    {5, {9763,9780}},
    {6, {9815,9821, 9823, 9832, 9848, 9849, 9851, 9854}},
    {7, {9856,9912}},
    // {8, {9856,9912, 9928,9928}},
    {8, {9928,9928}},
    {9, {9952,9966, 10019, 10035}},
    {10, {10074,10090, 10114, 10125}},
    {11, {10129,10149}},
    {12, {10150,10171}},
    {13, {10173,10203}},
    {14, {10204,10231}},
    {15, {10262,10278, 10298,10299, 10301,10301, 10304,10308}},
    {16, {10312,10342}},
    {17, {10344,10350, 10378,10394, 10552,10558}},
    {18, {10608,10648}},
    {19, {10651,10677}},
    {20, {10679,10717}},
    {21, {10745,10761, 10788,10803}},
    {22, {10830,10845, 10963,10976}},
    {23, {11002,11008, 11010,11019, 11046,11066}},
    {24, {11083,11113}},
    {25, {11114,11144}},
    {26, {11145,11175}},
    {27, {11176,11200, 11403,11410}},
    {28, {11414,11417, 11419,11426, 11428,11432, 11434,11444, 11446,11451}},
    {29, {11453,11453, 11455,11458, 11466,11476, 11477,11483}},
    {30, {12521,12522, 12525,12526, 12528,12537, 12539,12539, 12541,12543, 12545,12547, 12549,12550}},
    {31, {12551,12551, 12553,12560, 12562,12575, 12577,12578, 12580,12580}},
    {32, {12607,12625, 12636,12647, 12652,12653}},
    {33, {12664,12675}},
    {34, {12677,12695, 12697,12724}},
    {35, {12736,12765}},
    {36, {12766,12798}},
    {37, {12816,12816, 12819,12819, 12824,12824, 12827,12827, 12829,12831, 12834,12838, 12842,12842, 12843,12861, 12875,12875}},
    {38, {13000,13003, 13005,13028}},
    {39, {13029,13053, 13055,13056}},
    {40, {13066,13070, 13076,13092, 13094,13096}},
    {41, {13100,13115, 13117,13119, 13123,13137}},
    {42, {13148,13150, 13154,13156, 13186,13189, 13191,13204, 13206,13211}},
    {43, {13212,13242}},
    {44, {13243,13275}},
    {45, {13276,13287, 13306,13311, 13313,13325}},
    {46, {13326,13350, 13362,13368}},
    {47, {13369,13383, 13396,13411}},
    {48, {13519,13548}},
    {49, {13699,13704, 13715,13719}},
    {50, {14010,14040, 14041,14041}},
    {51, {14342,14372, 14386,14387}}
  };

  // DS2 (P3KJR)
  else if (dsNum == 2) runRanges = {
    {0, {14775,14786, 14788,14805}},
    {1, {14908,14925, 14936,14941, 14943,14948}},
    {2, {15043,15052, 15062,15083}},
    {3, {15188,15188, 15190,15193, 15195,15218}},
    {4, {15324,15326, 15338,15338, 15343,15364}},
    {5, {15471,15483, 15511,15519, 15613,15621, 15625,15625}},
    {6, {15635,15657}},
    {7, {15763,15767, 15769,15787, 15797,15803}}
  };

  // DS3 (P3KJR)
  else if (dsNum == 3) runRanges = {
    {0, {16797,16826, 16827,16835}},
    {1, {16857,16886}},
    {2, {16887,16910, 16931,16935, 16947,16952}},
    {3, {16957,16959, 16970,16999}},
    {4, {17000,17009, 17035,17057}},
    {5, {17060,17090}},
    {6, {17091,17121}},
    {7, {17122,17127, 17129,17131, 17138,17156}},
    {8, {17159,17181, 17305,17318}},
    {9, {17322,17343}},
    {10, {17351,17381}},
    {11, {17382,17412, 17413,17422}},
    {12, {17448,17477}},
    {13, {17478,17493}},
    {14, {17500,17519}},
    {15, {17531,17553, 17555,17559}},
    {16, {17567,17597}},
    {17, {17598,17628}},
    {18, {17629,17659}},
    {19, {17660,17686}},
    {20, {17703,17717, 17720,17721}},
    {21, {17852,17882}},
    {22, {17883,17913}},
    {23, {17914,17944}},
    {24, {17945,17948, 17967,17980}}
  };

  // DS4 (P3LQG)
  else if(dsNum == 4) runRanges = {
    {0, {60000802,60000821, 60000823,60000823, 60000827,60000828, 60000830,60000830}},
    {1, {60000970,60001000}},
    {2, {60001001,60001010}},
    {3, {60001033,60001054, 60001056,60001062}},
    {4, {60001063,60001086}},
    {5, {60001088,60001093}},
    {6, {60001094,60001124}},
    {7, {60001125,60001125, 60001163,60001181, 60001183,60001185}},
    {8, {60001187,60001205, 60001309,60001319}},
    {9, {60001331,60001350, 60001380,60001382}},
    {10, {60001384,60001414}},
    {11, {60001415,60001441}},
    {12, {60001463,60001489}},
    {13, {60001491,60001506}},
    {14, {60001523,60001542}},
    {15, {60001597,60001624}},
    {16, {60001625,60001655}},
    {17, {60001656,60001686}},
    {18, {60001687,60001714}},
    /*
    {19, {60001756,60001786}},
    {20, {60001787,60001817}},
    {21, {60001818,60001848, 60001849,60001853}},
    {22, {60001874,60001888}}
    */
  };

  // DS5 (P3LQK)
  else if(dsNum == 5) runRanges = {
    {0, {18623,18624, 18628,18629, 18645,18652}},
    {1, {18654,18685}},
    {2, {18686,18703, 18707,18707}},
    {3, {18761,18783}},
    {4, {18808,18834}},
    {5, {18835,18838, 18844,18844, 18883,18914}},
    {6, {18915,18918, 18920,18951, 18952,18957}},
    {7, {19240,19240, 19264,19280, 19305,19318}},
    {8, {19320,19351}},
    {9, {19352,19383}},
    {10, {19384,19385, 19387,19415}},
    {11, {19416,19425, 19428,19430, 19436,19445}},
    {12, {19481,19496, 19502,19515}},
    {13, {19613,19644}},
    {14, {19645,19676}},
    {15, {19677,19677, 19696,19697, 19707,19722}},
    {16, {19733,19747, 19771,19773}},
    {17, {19775,19801, 19806,19806}},
    {18, {19834,19860}},
    {19, {19862,19893}},
    {20, {19894,19899, 19901,19907}},
    {21, {19968,19998}},
    {22, {19999,19999, 20021,20040}},
    {23, {20074,20105}},
    {24, {20106,20130, 20132,20134}},
    {25, {20136,20167}},
    {26, {20168,20199}},
    {27, {20218,20237}},
    {28, {20239,20270}},
    {29, {20271,20286, 20311,20316, 20319,20332}},
    {30, {20335,20365}},
    {31, {20366,20375, 20377,20397}},
    {32, {20398,20415}},
    {33, {20417,20445}},
    {34, {20483,20487, 20489,20491, 20494,20509}},
    {35, {20522,20537}},
    {36, {20611,20629, 20686,20691}},
    {37, {20755,20756, 20758,20786}},
    {38, {20787,20795, 20797,20828}},
    {39, {20829,20860}},
    {40, {20861,20876, 20877,20882}},
    {41, {20884,20915}},
    {42, {20916,20927, 20929,20957}},
    {43, {20964,20995}},
    {44, {20996,21012}},
    {45, {21014,21045}},
    {46, {21046,21058}},
    {47, {21060,21091}},
    {48, {21092,21104}},
    {49, {21106,21136}},
    {50, {21158,21167, 21169,21178, 21201,21201}},
    {51, {21217,21248}},
    {52, {21249,21278}},
    {53, {21280,21311}},
    {54, {21312,21343}},
    {55, {21344,21375}},
    {56, {21376,21389, 21391,21407}},
    {57, {21408,21424, 21426,21435, 21452,21453}},
    {58, {21469,21499}},
    {59, {21501,21532}},
    {60, {21533,21564}},
    {61, {21565,21585, 21587,21587}},
    {62, {21595,21614, 21617,21618, 21622,21628}},
    {63, {21630,21661}},
    {64, {21662,21674, 21691,21692, 21694,21705}},
    {65, {21747,21776}},
    {66, {21778,21800, 21833,21837}},
    {67, {21839,21853, 21856,21857, 21862,21879}},
    {68, {21891,21893, 21895,21908, 21922,21937}},
    {69, {21940,21940, 21953,21968}},
    {70, {22001,22032}},
    {71, {22033,22064}},
    {72, {22065,22095}},
    {73, {22097,22100, 22102,22122}},
    {74, {22127,22142}},
    {75, {22147,22171, 22173,22176}},
    {76, {22180,22213}},
    {77, {22214,22247}},
    {78, {22248,22250, 22266,22280, 22304,22304, 22316,22333}},
    {79, {22340,22356, 22369,22392}},
    {80, {22400,22428}},
    {81, {22430,22463}},
    {82, {22464,22488}},
    {83, {22490,22512, 22636,22644, 22647,22650}},
    {84, {22652,22653, 22655,22670, 22673,22674}},
    {85, {22678,22711}},
    {86, {22712,22742}},
    {87, {22744,22750, 22753,22755, 22760,22763, 22765,22777, 22814,22815}},
    {88, {22817,22834, 22838,22838, 22840,22840, 22853,22853, 22867,22867}},
    {89, {22876,22909}},
    {90, {22910,22943}},
    {91, {22944,22946, 22952,22952, 22954,22954, 22959,22982, 22984,22986}},
    {92, {22993,22996, 23085, 23101}},
    {93, {23111,23144}},
    {94, {23145,23175, 23211,23212}},
    {95, {23218,23232 ,23246,23260, 23262,23262}},
    {96, {23282,23306}},
    {97, {23308,23334}},
    {98, {23338,23370}},
    {99, {23372,23405}},
    {100, {23406,23433}},
    {101, {23440,23458, 23461,23462, 23469,23480}},
    {102, {23511,23513, 23520,23521, 23525,23542, 23548,23548}},
    {103, {23551,23584}},
    {104, {23585,23618}},
    {105, {23619,23642}},
    {106, {23645,23668, 23675,23690}},
    {107, {23704,23715, 23718,23719, 23721,23721}},
    {108, {23725,23758}},
    {109, {23759,23792}},
    {110, {23793,23826}},
    {111, {23827,23849, 23851,23867}},
    {112, {23869,23881, 23939,23940, 23942,23958}}
  };

  // DS6 (P3LTP)
  else if(dsNum == 6) runRanges = {
    // {0, {25704,25737}},
    // {1, {25738,25771}},
    // {2, {25772,25792}},
    // {3, {25794,25827}},
    // {4, {25828,25832, 25936,25936, 26022,26022, 26023,26038, 26052,26066}},
    // {5, {26163,26169, 26171,26177, 26179,26190}}
    {0, {25704,25725,  25728,25737}},
    {1, {25738,25756,  25759,25763,  25765,25771}},
    {2, {25772,25787,  25790,25800}},
    {3, {25801,25819,  25822,25830}},
    {4, {26023,26034,  26036,26038,  26052,26066}},
    {5, {26163,26169,  26171,26176,  26179,26190}},
    {6, {26191,26192,  26194,26194,  26313,26325,  26328,26344}},
    {7, {26465,26490,  26493,26495}},
    {8, {26591,26601,  26603,26616,  26617,26617,  26619,26622}},
    {9, {26742,26745,  26773,26773,  26775,26776,  26780,26789,  26791,26805}},
    {10, {26907,26918,  26920,26938}},
    {11, {27060,27070,  27074,27091}},
    {12, {27217,27224,  27227,27248}},
    {13, {27920,27922,  27924,27930,  27932,27936,  27958,27969}},
    {14, {27991,28013,  28015,28018}},
    {15, {28019,28035,  28037,28045,  28048,28049}},
    {16, {28050,28072,  28074,28076,  28079,28080}},
    {17, {28081,28108,  28111,28111}},
    {18, {28136,28160}},
    {19, {28161,28161,  28164,28169,  28171,28186}},
    {20, {28300,28320}},
    {21, {28391,28402}},
    {22, {28403,28406,  28409,28422,  28662,28673}},
    {23, {28674,28683,  28685,28688,  28690,28693,  28813,28816,  28818,28824}},
    {24, {28825,28837,  28840,28844,  28942,28955}},
    {25, {28956,28964,  28967,28967,  28992,28997}},
    {26, {29092,29105,  29109,29122,  29124,29124}}
  };

  else {
    cout << "Error: LoadDataSet(): Unknown dataset: " << dsNum << endl;
    return runRanges;
  }

  // Now add the runs to the GATDataSet object
  // Increment by 2, always assume pairwise
  // If subDS number is <0, add all subDSs in the DS
  if(subNum<0)
    for(auto& subDS : runRanges)
      for (size_t i = 0; i < subDS.second.size(); i+=2)
	ds.AddRunRange(subDS.second[i], subDS.second[i+1]);
  else
    for (size_t i = 0; i < runRanges[subNum].size(); i+=2)
      ds.AddRunRange(runRanges[subNum][i], runRanges[subNum][i+1]);

  return runRanges;
}


vector<int> LoadDetectorList(int module)
{
  vector<int> detectorList;
  if (module==1) detectorList = {
    1426981, 1425750, 1426612, 1425380, 28474, 1426640, 1426650, 1426622,
    28480, 1426980, 1425381, 1425730, 28455, 28470, 28463, 28465, 28469,
    28477, 1425751, 1426610, 1425731, 1425742, 1426611, 1425740, 1426620,
    28482, 1425741, 1426621, 1425370
    };
  else if (module==2) detectorList = {
    28459, 1426641, 1427481, 1427480, 28481, 28576, 28594, 28595, 28461, 1427490,
    1427491, 1428530, 28607, 28456, 28621, 28466, 28473, 28487, 1426651, 1428531,
    1427120, 1235170, 1429091, 1429092, 1426652, 28619, 1427121, 1429090, 28717
    };
  return detectorList;
}


void GetTotalActiveMass(int dsNum, double& m1Total, double& m1Enr, double& m1Nat,
  double& m2Total, double& m2Enr, double& m2Nat)
{
  m1Total=0, m1Enr=0, m1Nat=0, m2Total=0, m2Enr=0, m2Nat=0;

  if (dsNum == 0)      { m1Total = 14.60;  m1Enr = 10.69;  m1Nat = 3.91; }
  else if (dsNum == 1) { m1Total = 13.02;  m1Enr = 11.90;  m1Nat = 1.12; }
  else if (dsNum == 2) { m1Total = 12.43;  m1Enr = 11.31;  m1Nat = 1.12; }
  else if (dsNum == 3) { m1Total = 15.41;  m1Enr = 12.63;  m1Nat = 2.78; }
  else if (dsNum == 4) { m2Total = 9.421;  m2Enr = 5.471;  m2Nat = 3.95; }
  else if (dsNum == 5) { m1Total = 16.54;  m1Enr = 12.63;  m1Nat = 3.91;
                         m2Total = 10.90;  m2Enr = 5.81;   m2Nat = 5.09; }
  else if (dsNum == 6) { m1Total = 15.98;  m1Enr = 12.63;  m1Nat = 3.35;
                         m2Total = 10.90;  m2Enr = 5.81;   m2Nat = 5.09; }
  else cout << "Error: GetTotalActiveMass(): Unknown dataset: " << dsNum << endl;
}


map<int,double> LoadActiveMasses(int dsNum)
{
  map<int,double> activeMassForDetID_g;
  if (dsNum==0 || dsNum==1 || dsNum==2 || dsNum==3) {
    activeMassForDetID_g = {
      {1426981, 510}, {1425750, 979}, {1426612, 811}, {1425380, 968},
      {28474, 560}, {1426640, 723}, {1426650, 659}, {1426622, 689},
      {28480, 551}, {1426980, 886}, {1425381, 949}, {1425730, 1024},
      {28455, 558}, {28470, 564}, {28463, 567}, {28465, 545}, {28469, 557},
      {28477, 553}, {1425751, 730}, {1426610, 632}, {1425731, 982},
      {1425742, 732}, {1426611, 675}, {1425740, 701}, {1426620, 572.2},
      {28482, 561}, {1425741, 710}, {1426621, 590.8}, {1425370, 964} };
  }
  else if (dsNum == 4) {
    activeMassForDetID_g = {
      {28459, 556}, {1426641, 576}, {1427481, 903}, {1427480, 917},
      {28481, 581}, {28576, 562}, {28594, 559}, {28595, 558}, {28461, 577},
      {1427490, 872}, {1427491, 852}, {1428530, 996}, {28607, 558},
      {28456, 579}, {28621, 565}, {28466, 566}, {28473, 562}, {28487, 557},
      {1426651, 591}, {1428531, 1031}, {1427120, 802}, {1235170, 462.2},
      {1429091, 775}, {1429092, 821}, {1426652, 778}, {28619, 566},
      {1427121, 968}, {1429090, 562}, {28717, 567} };
  }
  else if (dsNum == 5 || dsNum == 6) {
    activeMassForDetID_g = {
      // M1
      {1426981, 510}, {1425750, 979}, {1426612, 811}, {1425380, 968},
      {28474, 560}, {1426640, 723}, {1426650, 659}, {1426622, 689},
      {28480, 551}, {1426980, 886}, {1425381, 949}, {1425730, 1024},
      {28455, 558}, {28470, 564}, {28463, 567}, {28465, 545}, {28469, 557},
      {28477, 553}, {1425751, 730}, {1426610, 632}, {1425731, 982},
      {1425742, 732}, {1426611, 675}, {1425740, 701}, {1426620, 572.2},
      {28482, 561}, {1425741, 710}, {1426621, 590.8}, {1425370, 964},
      // M2
      {28459, 556}, {1426641, 576}, {1427481, 903},{1427480, 917},
      {28481, 581}, {28576, 562}, {28594, 559}, {28595, 558}, {28461, 577},
      {1427490, 872}, {1427491, 852}, {1428530, 996}, {28607, 558},
      {28456, 579}, {28621, 565}, {28466, 566}, {28473, 562}, {28487, 557},
      {1426651, 591}, {1428531, 1031}, {1427120, 802}, {1235170, 462.2},
      {1429091, 775}, {1429092, 821}, {1426652, 778}, {28619, 566},
      {1427121, 968}, {1429090, 562}, {28717, 567} };
  }
  else cout << "Error: LoadActiveMasses(): unknown dataset number: " << dsNum << endl;

  return activeMassForDetID_g;
}


map<int,double> LoadActiveMassUncertainties(int dsNum)
{
  map<int,double> activeMassUncForDetID_g;
  if (dsNum==0 || dsNum==1 || dsNum==2 || dsNum==3) {
    activeMassUncForDetID_g = {
      {1426981, 10}, {1425750, 13}, {1426612, 12}, {1425380, 13},       // C1P1
      {28474, 13}, {1426640, 11}, {1426650, 11}, {1426622, 10},         // C1P2
      {28480, 13}, {1426980, 12}, {1425381, 13}, {1425730, 14},         // C1P3
      {28455, 13}, {28470, 13}, {28463, 13}, {28465, 12}, {28469, 13},  // C1P4
      {28477, 13}, {1425751, 11}, {1426610, 11}, {1425731, 13},         // C1P5
      {1425742, 11}, {1426611, 12}, {1425740, 11}, {1426620, 9.4},      // C1P6
      {28482, 13}, {1425741, 11}, {1426621, 9}, {1425370, 13} };        // C1P7
  }
  else if (dsNum == 4) {
    activeMassUncForDetID_g = {
      {28459, 13}, {1426641, 9}, {1427481, 12}, {1427480, 12},          // C2P1
      {28481, 13}, {28576, 13}, {28594, 13}, {28595, 13}, {28461, 13},  // C2P2
      {1427490, 12}, {1427491, 11}, {1428530, 12},                      // C2P3
      {28607, 13}, {28456, 13}, {28621, 13}, {28466, 13}, {28473, 13},  // C2P4
      {28487, 13}, {1426651, 10}, {1428531, 13}, {1427120, 11},         // C2P5
      {1235170, 8.4}, {1429091, 12}, {1429092, 11}, {1426652, 11},      // C2P6
      {28619, 13}, {1427121, 12}, {1429090, 10}, {28717, 13} };         // C2P7
  }
  else if (dsNum == 5 || dsNum == 6) {
    activeMassUncForDetID_g = {
      // M1
      {1426981, 10}, {1425750, 13}, {1426612, 12}, {1425380, 13},       // C1P1
      {28474, 13}, {1426640, 11}, {1426650, 11}, {1426622, 10},         // C1P2
      {28480, 13}, {1426980, 12}, {1425381, 13}, {1425730, 14},         // C1P3
      {28455, 13}, {28470, 13}, {28463, 13}, {28465, 12}, {28469, 13},  // C1P4
      {28477, 13}, {1425751, 11}, {1426610, 11}, {1425731, 13},         // C1P5
      {1425742, 11}, {1426611, 12}, {1425740, 11}, {1426620, 9.4},      // C1P6
      {28482, 13}, {1425741, 11}, {1426621, 9}, {1425370, 13},        // C1P7
      // M2
      {28459, 13}, {1426641, 9}, {1427481, 12}, {1427480, 12},          // C2P1
      {28481, 13}, {28576, 13}, {28594, 13}, {28595, 13}, {28461, 13},  // C2P2
      {1427490, 12}, {1427491, 11}, {1428530, 12},                      // C2P3
      {28607, 13}, {28456, 13}, {28621, 13}, {28466, 13}, {28473, 13},  // C2P4
      {28487, 13}, {1426651, 10}, {1428531, 13}, {1427120, 11},         // C2P5
      {1235170, 8.4}, {1429091, 12}, {1429092, 11}, {1426652, 11},      // C2P6
      {28619, 13}, {1427121, 12}, {1429090, 10}, {28717, 13}            // C2P7
    };
  }
  else cout << "Error: LoadActiveMassUncertainties(): unknown dataset number: " << dsNum << endl;

  return activeMassUncForDetID_g;
}


map<int, bool> LoadBadDetectorMap(int dsNum)
{
  map<int,bool> detIDIsBad;
  if(dsNum == 0)
    detIDIsBad = { {28474,1},   {1426622,1}, {28480,1},      // 1 is true
                   {1426980,1}, {1426620,1}, {1425370,1} };

  else if(dsNum == 1)
    detIDIsBad = { {1426981,1}, {1426622,1}, {28455,1},
                   {28470,1},   {28463,1},   {28465,1},
                   {28469,1},   {28477,1},   {1425751,1},
                   {1425731,1}, {1426611,1} };

  else if (dsNum == 2)
    detIDIsBad = { {1426981,1}, {1426622,1}, {28455,1},
                   {28470,1},   {28463,1},   {28465,1},
                   {28469,1},   {28477,1},   {1425731,1},
                   {1426611,1} };

  else if (dsNum == 3)
    detIDIsBad = { {1426981,1}, {1426622,1}, {28477,1},
                   {1425731,1}, {1426611,1} };

  else if (dsNum == 4)
    detIDIsBad = { {28595,1},   {28461,1},   {1428530,1},
                   {28621,1},   {28473,1},   {1426651,1},
                   {1429092,1}, {1426652,1}, {28619,1} };

  else if (dsNum == 5)
    detIDIsBad = { {1426981,1}, {1426622,1}, {28477,1},
		               {1425731,1}, {1426611,1}, {28595,1},
		               {28461,1},   {1428530,1}, {28621,1},
		               {28473,1},   {1426651,1}, {1429092,1},
		               {1426652,1}, {28619,1},   {1427121,1} };

  else if (dsNum == 6)
    detIDIsBad = { {1426981,1}, {28474,1}, {1426622,1},
		   {28477,1}, {1425731,1}, {1426611,1},
 		   {28595,1}, {28461,1}, {1428530,1},
		   {28621,1}, {28473,1}, {1426651,1},
		   {1429092,1}, {1426652,1}, {28619,1},
		   {1427121,1}};

  else cout << "Error: LoadBadDetectorMap(): Unknown dataset number: " << dsNum << endl;
  return detIDIsBad;
}


map<int,bool> LoadVetoDetectorMap(int dsNum)
{
  map<int,bool> detIDIsVetoOnly;
  if (dsNum == 0)      detIDIsVetoOnly = { {1425381,1}, {1425742,1} };
  else if (dsNum == 1) detIDIsVetoOnly = { {28480,1} };
  else if (dsNum == 2) detIDIsVetoOnly = { {28480,1},   {1425751,1}, {1426621,1} };
  else if (dsNum == 3) detIDIsVetoOnly = { {28480,1},   {28470,1},   {28463,1} };
  else if (dsNum == 4) detIDIsVetoOnly = { {28459,1},   {1426641,1}, {1427481,1},
                                           {28456,1},   {1427120,1}, {1427121,1} };
  else if (dsNum == 5) detIDIsVetoOnly = { {28480,1},   {1426641,1}, {1427481,1},
					   {1235170,1} };
  else if (dsNum == 6) detIDIsVetoOnly = { {28480,1},   {1426641,1}, {1427481,1},
					   {1235170,1} };
  else cout << "Error: LoadVetoDetectorMap(): Unknown dataset number: " << dsNum << endl;
  return detIDIsVetoOnly;
}


std::string GetChannelSelectionPath(int dsNum, int officialVersion = -1){

    //First, check whether an official version has been requested.
    //Official versions start at 1, and get a version tag of the form
    //v_00000001-<officialVersion, with leading zeros to a total of 5 digits>
    //e.g. v_00000001-00001 for the first official version.
    //They are stored in $MJDDATADIR/surfmjd/analysis/channelselection,
    //using the same directory structure as current versions.  This way the
    //official record is kept in the official place, and if development
    //versions are also being put there in the future, the automatic "most
    //recent version" check will not clash with the existence of official
    //versions.  Furthermore, v_00000000 series versions can be reserved for
    //testing purposes.
    //=======================================================================
    //Log which official version corresponds to which final analysis here.
    //=======================================================================
    //v_00000001-00001: 2017 neutrinoless double beta decay paper
    //-----------------------------------------------------------------------
    if(officialVersion > 0){

        char const* tmpPath = std::getenv("MJDDATADIR");

        //If MJDDATADIR is somehow not set, default to looking at the most
        //recent version.
        if(tmpPath == NULL){
            std::cout << "ERROR: Environment variable MJDDATADIR not set, so cannot find official channel selection version." << std::endl;
            std::cout << "Defaulting to most recent version of channel selection." << std::endl;
        }

        //Otherwise, built the correct path to the files, and return that.
        else{

            std::string pathToFiles(tmpPath);
            std::string verString = std::to_string(officialVersion);
            std::string fullVerString = std::string(5-verString.length(),'0') + verString;
            pathToFiles += "/surfmjd/analysis/channelselection/DS" + std::to_string(dsNum) + "/v_00000001-" + fullVerString;

            //We now have the full path to the files for this dataset.  Return
            //it.
            return pathToFiles;
        }


    }

    //Where the channel selection information is stored.
    std::string baseDir("/global/projecta/projectdirs/majorana/users/jwmyslik/analysis/channelselection/");

    //Next, get everything in that directory.
    glob_t dirGlob;

    glob((baseDir + "DS" + std::to_string(dsNum) + "/*").c_str(), GLOB_TILDE, NULL, &dirGlob);

    std::vector<std::string> dirList;
    for(unsigned int i =0; i < dirGlob.gl_pathc; i++){

        dirList.push_back(dirGlob.gl_pathv[i]);
    }

    //Free the structure.
    if(dirGlob.gl_pathc > 0){
        globfree(&dirGlob);
    }

    //Now, loop through the directory list, and find the largest version
    //number.
    int newestDate = 0;
    int newestVersion = 0;
    int currentDate = 0;
    int currentVersion = 0;

    unsigned int bestIndex = 0;

    for(unsigned int i = 0; i < dirList.size(); i++){

        //Get the date and version number from the path. Since the end of the
        //string will always be YYYYMMDD-VVVVV, this will always separate out
        //date and version.
        std::string dateString = dirList[i].substr(dirList[i].length() - 14, 8);
        std::string verString = dirList[i].substr(dirList[i].length() - 5, 5);

        currentDate = atoi(dateString.c_str());
        currentVersion = atoi(verString.c_str());

        //If it's a newer date, reset newestDate and newestVersion
        if(currentDate > newestDate){
            newestDate = currentDate;
            newestVersion = currentVersion;
            bestIndex = i;
        }

        //If it's the same date, but a newer version, just change the version.
        else if(currentDate == newestDate){

            if(currentVersion > newestVersion){
                newestVersion = currentVersion;
                bestIndex = i;
            }
        }
    }

    //If there's nothing in dirList (because glob didn't find any directory
    //candidates) just return the base directory.  File loading will then
    //proceed to fail as gracefully as possible.
    if(dirList.size() < 1){
        return baseDir;
    }
    else{
        return dirList[bestIndex];
    }
}


map<int, bool> LoadEnrNatMap()
{
  // "1" denotes enriched, "0" denotes natural.
  map<int,bool> EnrNatMap = {
    // M1
    {1426981, 1}, {1425750, 1}, {1426612, 1}, {1425380, 1},
    {28474, 0}, {1426640, 1}, {1426650, 1}, {1426622, 1},
    {28480, 0}, {1426980, 1}, {1425381, 1}, {1425730, 1},
    {28455, 0}, {28470, 0}, {28463, 0}, {28465, 0}, {28469, 0},
    {28477, 0}, {1425751, 1}, {1426610, 1}, {1425731, 1},
    {1425742, 1}, {1426611, 1}, {1425740, 1}, {1426620, 1},
    {28482, 0}, {1425741, 1}, {1426621, 1}, {1425370, 1},
    // M2
    {28459, 0}, {1426641, 1}, {1427481, 1},{1427480, 1},
    {28481, 0}, {28576, 0}, {28594, 0}, {28595, 0}, {28461, 0},
    {1427490, 1}, {1427491, 1}, {1428530, 1}, {28607, 0},
    {28456, 0}, {28621, 0}, {28466, 0}, {28473, 0}, {28487, 0},
    {1426651, 1}, {1428531, 1}, {1427120, 1}, {1235170, 1},
    {1429091, 1}, {1429092, 1}, {1426652, 1}, {28619, 0},
    {1427121, 1}, {1429090, 1}, {28717, 0}
  };
  return EnrNatMap;
}


int CheckModule(int detID)
{
  vector<int> m1 = LoadDetectorList(1);
  vector<int> m2 = LoadDetectorList(2);

  bool isM1=false, isM2=false;
  isM1 = (find(m1.begin(), m1.end(), detID) != m1.end());
  if (!isM1) isM2 = (find(m2.begin(), m2.end(), detID) != m2.end());

  if (isM1) return 1;
  else if (isM2) return 2;
  else return 0;
}


void GetVetoActiveMass(map<int,double> actM4Det_g, map<int,bool> detIDIsVetoOnly,
  double &mVeto_M1Total_kg, double &mVeto_M2Total_kg)
{
  // Assumes you have ALREADY loaded the DS-appropriate list into the two maps,
  // using LoadVetoDetectorMap(dsNum) and LoadActiveMasses(dsNum);
  // Loops over the veto-only detector map, finds this detector's home,
  // and adds to the appropriate mass variable.
  for (auto const& x : detIDIsVetoOnly) {
    int detID = x.first;
    double detMass_kg = actM4Det_g[detID]/1000;
    int module = CheckModule(detID);
    // cout << detID << "  " << detMass_kg << "  " << module << endl;
    if (module==1) mVeto_M1Total_kg += detMass_kg;
    else if (module==2) mVeto_M2Total_kg += detMass_kg;
    else {
      cout << "Error: GetVetoActiveMass():  Unknown detector ID " << detID << endl;
      return;
    }
  }
}


bool GetLNRunCoverage(int dsNum, int run)
{
  // Requested by Jason at the internal 0nbb review, 30 Aug. 2017.
  // Given a run and DS number, verify that this run is covered by the most recent LN Fill Tag.
  // This function MUST be updated manually when 'LoadLNFillTimes1/2' are updated.

  // LN tag was most recently run on 20 Jul 2017, for DS0-5.
  if (dsNum==0 && run >= 2580 && run <= 6963) return true;
  if (dsNum==1 && run >= 9422 && run <= 14502)  return true;
  if (dsNum==2 && run >= 14503 && run <= 15892) return true;
  if (dsNum==3 && run >= 16797 && run <= 17980) return true;
  if (dsNum==4 && run >= 60000802 && run <= 60001888) return true;
  if (dsNum==5 && run >= 18623 && run < 25671) return true;
  if (dsNum==6) return false;
  return false;
}


void LoadDS4MuonList(vector<int> &muRuns, vector<double> &muRunTStarts,
  vector<double> &muTimes,vector<int> &muTypes, vector<double> &muUncert)
{
  // Created by "GenerateDS4MuonList" in $GATDIR/mjd-veto/skim-veto.cc

  vector<int> ds4muRuns = {60000804, 60000804, 60000804, 60000804, 60000804, 60000805, 60000806, 60000807, 60000807, 60000807, 60000808, 60000809, 60000810, 60000810, 60000810, 60000810, 60000811, 60000811, 60000813, 60000814, 60000814, 60000815, 60000816, 60000816, 60000817, 60000818, 60000819, 60000819, 60000820, 60000821, 60000827, 60000828, 60000830, 60000851, 60000851, 60000855, 60000858, 60000858, 60000858, 60000859, 60000859, 60000861, 60000862, 60000869, 60000870, 60000871, 60000872, 60000873, 60000873, 60000874, 60000875, 60000875, 60000876, 60000876, 60000877, 60000877, 60000878, 60000881, 60000882, 60000883, 60000883, 60000883, 60000884, 60000884, 60000885, 60000885, 60000886, 60000887, 60000887, 60000887, 60000890, 60000890, 60000892, 60000893, 60000893, 60000894, 60000894, 60000894, 60000895, 60000896, 60000896, 60000897, 60000897, 60000899, 60000900, 60000900, 60000902, 60000902, 60000902, 60000902, 60000903, 60000903, 60000903, 60000903, 60000903, 60000904, 60000905, 60000906, 60000908, 60000909, 60000909, 60000910, 60000910, 60000910, 60000912, 60000913, 60000914, 60000914, 60000915, 60000915, 60000915, 60000916, 60000917, 60000917, 60000919, 60000919, 60000919, 60000919, 60000922, 60000928, 60000929, 60000929, 60000929, 60000929, 60000929, 60000930, 60000930, 60000930, 60000930, 60000931, 60000931, 60000932, 60000933, 60000937, 60000937, 60000937, 60000938, 60000938, 60000940, 60000940, 60000941, 60000942, 60000942, 60000953, 60000970, 60000971, 60000972, 60000972, 60000973, 60000974, 60000974, 60000976, 60000976, 60000976, 60000976, 60000977, 60000977, 60000977, 60000977, 60000978, 60000979, 60000979, 60000979, 60000980, 60000982, 60000985, 60000985, 60000986, 60000986, 60000987, 60000988, 60000989, 60000989, 60000990, 60000992, 60000992, 60000993, 60000994, 60000994, 60000994, 60000995, 60000995, 60000996, 60000997, 60000997, 60000997, 60000998, 60000998, 60000998, 60000999, 60000999, 60000999, 60001000, 60001001, 60001001, 60001001, 60001002, 60001002, 60001002, 60001003, 60001004, 60001004, 60001004, 60001005, 60001006, 60001008, 60001008, 60001010, 60001033, 60001034, 60001035, 60001035, 60001037, 60001037, 60001037, 60001038, 60001038, 60001038, 60001039, 60001039, 60001040, 60001042, 60001042, 60001042, 60001043, 60001043, 60001045, 60001046, 60001048, 60001050, 60001050, 60001051, 60001052, 60001052, 60001052, 60001053, 60001053, 60001053, 60001054, 60001054, 60001055, 60001056, 60001056, 60001056, 60001057, 60001058, 60001058, 60001058, 60001059, 60001059, 60001060, 60001061, 60001061, 60001063, 60001063, 60001065, 60001065, 60001066, 60001066, 60001066, 60001068, 60001069, 60001069, 60001069, 60001070, 60001070, 60001070, 60001072, 60001072, 60001074, 60001074, 60001075, 60001075, 60001075, 60001077, 60001078, 60001078, 60001078, 60001078, 60001078, 60001079, 60001082, 60001082, 60001082, 60001083, 60001084, 60001084, 60001084, 60001085, 60001086, 60001086, 60001086, 60001088, 60001089, 60001089, 60001089, 60001091, 60001091, 60001092, 60001092, 60001093, 60001093, 60001094, 60001094, 60001096, 60001097, 60001097, 60001097, 60001098, 60001098, 60001100, 60001100, 60001100, 60001100, 60001100, 60001100, 60001101, 60001101, 60001102, 60001102, 60001103, 60001104, 60001104, 60001104, 60001107, 60001107, 60001107, 60001108, 60001108, 60001110, 60001111, 60001112, 60001112, 60001114, 60001114, 60001115, 60001115, 60001116, 60001117, 60001120, 60001121, 60001121, 60001122, 60001122, 60001123, 60001123, 60001165, 60001167, 60001168, 60001168, 60001169, 60001169, 60001169, 60001170, 60001170, 60001172, 60001175, 60001176, 60001177, 60001177, 60001177, 60001178, 60001178, 60001184, 60001184, 60001185, 60001188, 60001188, 60001189, 60001189, 60001190, 60001191, 60001191, 60001192, 60001192, 60001192, 60001193, 60001193, 60001193, 60001193, 60001194, 60001194, 60001194, 60001194, 60001195, 60001197, 60001197, 60001197, 60001198, 60001198, 60001199, 60001201, 60001203, 60001203, 60001203, 60001203, 60001204, 60001204, 60001205, 60001308, 60001308, 60001309, 60001310, 60001310, 60001311, 60001312, 60001313, 60001313, 60001313, 60001313, 60001315, 60001317, 60001317, 60001317, 60001318, 60001319, 60001330, 60001330, 60001330, 60001332, 60001333, 60001333, 60001333, 60001334, 60001334, 60001335, 60001335, 60001336, 60001337, 60001337, 60001338, 60001338, 60001339, 60001341, 60001341, 60001342, 60001342, 60001342, 60001342, 60001343, 60001343, 60001344, 60001344, 60001344, 60001345, 60001345, 60001346, 60001346, 60001346, 60001346, 60001347, 60001348, 60001350, 60001379, 60001379, 60001380, 60001381, 60001381, 60001381, 60001382, 60001382, 60001385, 60001386, 60001386, 60001387, 60001387, 60001387, 60001388, 60001389, 60001390, 60001390, 60001390, 60001391, 60001391, 60001391, 60001392, 60001394, 60001395, 60001397, 60001399, 60001399, 60001400, 60001403, 60001405, 60001405, 60001406, 60001406, 60001407, 60001408, 60001410, 60001410, 60001410, 60001410, 60001411, 60001412, 60001412, 60001413, 60001414, 60001415, 60001415, 60001416, 60001416, 60001417, 60001417, 60001418, 60001418, 60001418, 60001418, 60001419, 60001420, 60001420, 60001421, 60001421, 60001421, 60001424, 60001424, 60001426, 60001426, 60001427, 60001428, 60001429, 60001430, 60001430, 60001430, 60001431, 60001431, 60001432, 60001432, 60001433, 60001433, 60001434, 60001435, 60001435, 60001435, 60001436, 60001436, 60001437, 60001439, 60001463, 60001464, 60001465, 60001466, 60001467, 60001469, 60001470, 60001471, 60001471, 60001471, 60001472, 60001472, 60001473, 60001475, 60001475, 60001475, 60001475, 60001476, 60001477, 60001477, 60001478, 60001478, 60001478, 60001479, 60001480, 60001481, 60001482, 60001482, 60001482, 60001482, 60001483, 60001483, 60001484, 60001485, 60001485, 60001485, 60001487, 60001487, 60001488, 60001489, 60001491, 60001491, 60001491, 60001491, 60001492, 60001493, 60001493, 60001497, 60001497, 60001500, 60001500, 60001501, 60001501, 60001501, 60001501, 60001502, 60001502, 60001502, 60001503, 60001503, 60001504, 60001504, 60001505, 60001506, 60001507, 60001507, 60001507, 60001523, 60001523, 60001524, 60001524, 60001524, 60001524, 60001525, 60001525, 60001525, 60001525, 60001527, 60001527, 60001528, 60001529, 60001531, 60001532, 60001534, 60001535, 60001535, 60001536, 60001536, 60001537, 60001537, 60001537, 60001538, 60001538, 60001539, 60001541, 60001541, 60001541, 60001547, 60001548, 60001550, 60001553, 60001553, 60001553, 60001554, 60001554, 60001554, 60001555, 60001555, 60001559, 60001559, 60001560, 60001561, 60001562, 60001562, 60001564, 60001564, 60001565, 60001565, 60001567, 60001567, 60001568, 60001568, 60001568, 60001568, 60001572, 60001572, 60001572, 60001573, 60001575, 60001575, 60001576, 60001576, 60001594, 60001595, 60001596, 60001597, 60001597, 60001597, 60001597, 60001597, 60001599, 60001600, 60001600, 60001601, 60001602, 60001603, 60001603, 60001604, 60001605, 60001605, 60001606, 60001607, 60001607, 60001608, 60001610, 60001610, 60001610, 60001611, 60001612, 60001612, 60001613, 60001614, 60001616, 60001616, 60001616, 60001617, 60001617, 60001618, 60001618, 60001618, 60001619, 60001620, 60001621, 60001621, 60001622, 60001622, 60001623, 60001624, 60001625, 60001625, 60001627, 60001628, 60001629, 60001630, 60001631, 60001631, 60001632, 60001632, 60001633, 60001633, 60001633, 60001633, 60001633, 60001634, 60001635, 60001635, 60001635, 60001635, 60001637, 60001637, 60001640, 60001641, 60001642, 60001643, 60001643, 60001645, 60001645, 60001646, 60001646, 60001647, 60001647, 60001647, 60001648, 60001648, 60001649, 60001649, 60001650, 60001650, 60001652, 60001652, 60001653, 60001654, 60001655, 60001655, 60001655, 60001655, 60001657, 60001657, 60001658, 60001658, 60001659, 60001660, 60001661, 60001661, 60001662, 60001663, 60001664, 60001664, 60001666, 60001667, 60001668, 60001668, 60001668, 60001669, 60001669, 60001670, 60001671, 60001671, 60001671, 60001672, 60001672, 60001673, 60001674, 60001674, 60001674, 60001675, 60001675, 60001676, 60001676, 60001677, 60001678, 60001680, 60001681, 60001682, 60001682, 60001682, 60001683, 60001684, 60001686, 60001686, 60001690, 60001690, 60001690, 60001690, 60001691, 60001692, 60001692, 60001694, 60001695, 60001695, 60001695, 60001695, 60001695, 60001695, 60001695, 60001696, 60001696, 60001698, 60001701, 60001702, 60001702, 60001704, 60001704, 60001704, 60001704, 60001704, 60001705, 60001706, 60001706, 60001706, 60001706, 60001707, 60001708, 60001709, 60001709, 60001711, 60001711, 60001712, 60001713, 60001734, 60001734, 60001734, 60001734, 60001734, 60001734, 60001735, 60001735, 60001738, 60001739, 60001739, 60001739, 60001740, 60001740, 60001740, 60001740, 60001741, 60001742, 60001742, 60001744, 60001744, 60001744, 60001747, 60001748, 60001749, 60001750, 60001750, 60001750, 60001753, 60001753, 60001756, 60001757, 60001757, 60001758, 60001758, 60001759, 60001759, 60001760, 60001760, 60001762, 60001763, 60001764, 60001765, 60001765, 60001766, 60001767, 60001767, 60001768, 60001769, 60001769, 60001770, 60001770, 60001771, 60001771, 60001771, 60001771, 60001773, 60001773, 60001774, 60001774, 60001774, 60001775, 60001777, 60001777, 60001778, 60001779, 60001779, 60001780, 60001781, 60001783, 60001784, 60001785, 60001788, 60001789, 60001789, 60001789, 60001789, 60001789, 60001789, 60001789, 60001789, 60001790, 60001791, 60001792, 60001793, 60001793, 60001794, 60001794, 60001794, 60001795, 60001795, 60001796, 60001797, 60001798, 60001798, 60001799, 60001800, 60001800, 60001800, 60001800, 60001801, 60001801, 60001802, 60001802, 60001802, 60001803, 60001804, 60001805, 60001805, 60001805, 60001806, 60001806, 60001807, 60001810, 60001810, 60001810, 60001812, 60001812, 60001812, 60001813, 60001813, 60001814, 60001815, 60001816, 60001817, 60001819, 60001819, 60001820, 60001820, 60001820, 60001821, 60001821, 60001821, 60001822, 60001823, 60001824, 60001824, 60001827, 60001828, 60001828, 60001828, 60001829, 60001830, 60001831, 60001831, 60001831, 60001832, 60001833, 60001833, 60001834, 60001834, 60001835, 60001837, 60001838, 60001839, 60001840, 60001841, 60001841, 60001843, 60001843, 60001845, 60001846, 60001848, 60001848, 60001849, 60001850, 60001850, 60001851, 60001874, 60001877, 60001877, 60001879, 60001880, 60001880, 60001881, 60001881, 60001884, 60001884, 60001885, 60001885, 60001886, 60001886, 60001886, 60001887, 60001888, 60001888, 60001888};

  vector<int> ds4muTypes = {1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 3, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 2, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 3, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 3, 1, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 3, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1};

  vector<double> ds4muRunTStarts = {1472176844, 1472176844, 1472176844, 1472176844, 1472176844, 1472180445, 1472184046, 1472187647, 1472187647, 1472187647, 1472191248, 1472194849, 1472198450, 1472198450, 1472198450, 1472198450, 1472202051, 1472202051, 1472209253, 1472212854, 1472212854, 1472216455, 1472220132, 1472220132, 1472223734, 1472227335, 1472230936, 1472230936, 1472234537, 1472238138, 1472248439, 1472252041, 1472260415, 1472281685, 1472281685, 1472285849, 1472290926, 1472290926, 1472290926, 1472294527, 1472294527, 1472301731, 1472305333, 1472319709, 1472323311, 1472326912, 1472330512, 1472334113, 1472334113, 1472337714, 1472341314, 1472341314, 1472344915, 1472344915, 1472348516, 1472348516, 1472352117, 1472362920, 1472366522, 1472370124, 1472370124, 1472370124, 1472373726, 1472373726, 1472377327, 1472377327, 1472380928, 1472384529, 1472384529, 1472384529, 1472392234, 1472392234, 1472399436, 1472403037, 1472403037, 1472406638, 1472406638, 1472406638, 1472410239, 1472413840, 1472413840, 1472417441, 1472417441, 1472424643, 1472428244, 1472428244, 1472435445, 1472435445, 1472435445, 1472435445, 1472439046, 1472439046, 1472439046, 1472439046, 1472439046, 1472442647, 1472446248, 1472449849, 1472457060, 1472460662, 1472460662, 1472464263, 1472464263, 1472464263, 1472471467, 1472475069, 1472478671, 1472478671, 1472482272, 1472482272, 1472482272, 1472485872, 1472489474, 1472489474, 1472496677, 1472496677, 1472496677, 1472496677, 1472507480, 1472516318, 1472519919, 1472519919, 1472519919, 1472519919, 1472519919, 1472523521, 1472523521, 1472523521, 1472523521, 1472527123, 1472527123, 1472530725, 1472534328, 1472548733, 1472548733, 1472548733, 1472552335, 1472552335, 1472559538, 1472559538, 1472563140, 1472566750, 1472566750, 1472587788, 1472598175, 1472601776, 1472605377, 1472605377, 1472608978, 1472612579, 1472612579, 1472619780, 1472619780, 1472619780, 1472619780, 1472623382, 1472623382, 1472623382, 1472623382, 1472626544, 1472630145, 1472630145, 1472630145, 1472633747, 1472640949, 1472651752, 1472651752, 1472655353, 1472655353, 1472658954, 1472662555, 1472666156, 1472666156, 1472669758, 1472680927, 1472680927, 1472684528, 1472688129, 1472688129, 1472688129, 1472691730, 1472691730, 1472695331, 1472698932, 1472698932, 1472698932, 1472702534, 1472702534, 1472702534, 1472706135, 1472706135, 1472706135, 1472709736, 1472713337, 1472713337, 1472713337, 1472716939, 1472716939, 1472716939, 1472720540, 1472724141, 1472724141, 1472724141, 1472727744, 1472731344, 1472738547, 1472738547, 1472742831, 1472764639, 1472768240, 1472771841, 1472771841, 1472779043, 1472779043, 1472779043, 1472782644, 1472782644, 1472782644, 1472786245, 1472786245, 1472789846, 1472797048, 1472797048, 1472797048, 1472800649, 1472800649, 1472807851, 1472811452, 1472818654, 1472825857, 1472825857, 1472829458, 1472833060, 1472833060, 1472833060, 1472836662, 1472836662, 1472836662, 1472841171, 1472841171, 1472845579, 1472847120, 1472847120, 1472847120, 1472850721, 1472854322, 1472854322, 1472854322, 1472857923, 1472857923, 1472861524, 1472865126, 1472865126, 1472872327, 1472872327, 1472879530, 1472879530, 1472883131, 1472883131, 1472883131, 1472890334, 1472893935, 1472893935, 1472893935, 1472897536, 1472897536, 1472897536, 1472904738, 1472904738, 1472911942, 1472911942, 1472915544, 1472915544, 1472915544, 1472922750, 1472926351, 1472926351, 1472926351, 1472926351, 1472926351, 1472929953, 1472940755, 1472940755, 1472940755, 1472944356, 1472947957, 1472947957, 1472947957, 1472951558, 1472955159, 1472955159, 1472955159, 1472959093, 1472962694, 1472962694, 1472962694, 1472969898, 1472969898, 1472973499, 1472973499, 1472977102, 1472977102, 1472980703, 1472980703, 1472987906, 1472991508, 1472991508, 1472991508, 1472995109, 1472995109, 1473002314, 1473002314, 1473002314, 1473002314, 1473002314, 1473002314, 1473005915, 1473005915, 1473009516, 1473009516, 1473013117, 1473016717, 1473016717, 1473016717, 1473027521, 1473027521, 1473027521, 1473031122, 1473031122, 1473038324, 1473041925, 1473045526, 1473045526, 1473052727, 1473052727, 1473056329, 1473056329, 1473059930, 1473063532, 1473072692, 1473076295, 1473076295, 1473079896, 1473079896, 1473083497, 1473083497, 1473119190, 1473126392, 1473129994, 1473129994, 1473133595, 1473133595, 1473133595, 1473137196, 1473137196, 1473144398, 1473155201, 1473158802, 1473162403, 1473162403, 1473162403, 1473166004, 1473166004, 1473186282, 1473186282, 1473189884, 1473197655, 1473197655, 1473201256, 1473201256, 1473204857, 1473208458, 1473208458, 1473212059, 1473212059, 1473212059, 1473215660, 1473215660, 1473215660, 1473215660, 1473219260, 1473219260, 1473219260, 1473219260, 1473222861, 1473230062, 1473230062, 1473230062, 1473233664, 1473233664, 1473237266, 1473244468, 1473251671, 1473251671, 1473251671, 1473251671, 1473255274, 1473255274, 1473258875, 1473308230, 1473308230, 1473311832, 1473315433, 1473315433, 1473319035, 1473322636, 1473326236, 1473326236, 1473326236, 1473326236, 1473333439, 1473340642, 1473340642, 1473340642, 1473344244, 1473347845, 1473372321, 1473372321, 1473372321, 1473379523, 1473383124, 1473383124, 1473383124, 1473386726, 1473386726, 1473390327, 1473390327, 1473393928, 1473397530, 1473397530, 1473401131, 1473401131, 1473404734, 1473411937, 1473411937, 1473415537, 1473415537, 1473415537, 1473415537, 1473419138, 1473419138, 1473422739, 1473422739, 1473422739, 1473426340, 1473426340, 1473429941, 1473429941, 1473429941, 1473429941, 1473433542, 1473437145, 1473444346, 1473485455, 1473485455, 1473489057, 1473492659, 1473492659, 1473492659, 1473496261, 1473496261, 1473505796, 1473509397, 1473509397, 1473512998, 1473512998, 1473512998, 1473516599, 1473520201, 1473523803, 1473523803, 1473523803, 1473527404, 1473527404, 1473527404, 1473531005, 1473538207, 1473541808, 1473549009, 1473556212, 1473556212, 1473559813, 1473570615, 1473577818, 1473577818, 1473581420, 1473581420, 1473585021, 1473588622, 1473594188, 1473594188, 1473594188, 1473594188, 1473597790, 1473601391, 1473601391, 1473604992, 1473608594, 1473612196, 1473612196, 1473615798, 1473615798, 1473619399, 1473619399, 1473623000, 1473623000, 1473623000, 1473623000, 1473626601, 1473630202, 1473630202, 1473633803, 1473633803, 1473633803, 1473644607, 1473644607, 1473651809, 1473651809, 1473655410, 1473659011, 1473662614, 1473666216, 1473666216, 1473666216, 1473669818, 1473669818, 1473673419, 1473673419, 1473677021, 1473677021, 1473680623, 1473684225, 1473684225, 1473684225, 1473687826, 1473687826, 1473691427, 1473698629, 1473718354, 1473721956, 1473725557, 1473729159, 1473732761, 1473739963, 1473743564, 1473747166, 1473747166, 1473747166, 1473750768, 1473750768, 1473754371, 1473761574, 1473761574, 1473761574, 1473761574, 1473765175, 1473768776, 1473768776, 1473772378, 1473772378, 1473772378, 1473775979, 1473779580, 1473783181, 1473786782, 1473786782, 1473786782, 1473786782, 1473790383, 1473790383, 1473793985, 1473797587, 1473797587, 1473797587, 1473804790, 1473804790, 1473808391, 1473811992, 1473819019, 1473819019, 1473819019, 1473819019, 1473822620, 1473826221, 1473826221, 1473840627, 1473840627, 1473851431, 1473851431, 1473855032, 1473855032, 1473855032, 1473855032, 1473858635, 1473858635, 1473858635, 1473862239, 1473862239, 1473865840, 1473865840, 1473869443, 1473873044, 1473876645, 1473876645, 1473876645, 1473888082, 1473888082, 1473891683, 1473891683, 1473891683, 1473891683, 1473895284, 1473895284, 1473895284, 1473895284, 1473902487, 1473902487, 1473906088, 1473909688, 1473916890, 1473920493, 1473926698, 1473930302, 1473930302, 1473933904, 1473933904, 1473937507, 1473937507, 1473937507, 1473941108, 1473941108, 1473944709, 1473951912, 1473951912, 1473951912, 1473960766, 1473964367, 1473971571, 1473982376, 1473982376, 1473982376, 1473985977, 1473985977, 1473985977, 1473989579, 1473989579, 1474003984, 1474003984, 1474007585, 1474011186, 1474014790, 1474014790, 1474021992, 1474021992, 1474025593, 1474025593, 1474032796, 1474032796, 1474036397, 1474036397, 1474036397, 1474036397, 1474044816, 1474044816, 1474044816, 1474048418, 1474055621, 1474055621, 1474059221, 1474059221, 1474065319, 1474068923, 1474072525, 1474074859, 1474074859, 1474074859, 1474074859, 1474074859, 1474082062, 1474085663, 1474085663, 1474089264, 1474092865, 1474096467, 1474096467, 1474100069, 1474103671, 1474103671, 1474107271, 1474110873, 1474110873, 1474114474, 1474121677, 1474121677, 1474121677, 1474125278, 1474128879, 1474128879, 1474132480, 1474136081, 1474143283, 1474143283, 1474143283, 1474146884, 1474146884, 1474149949, 1474149949, 1474149949, 1474153551, 1474157152, 1474160754, 1474160754, 1474164354, 1474164354, 1474167955, 1474171556, 1474175158, 1474175158, 1474182361, 1474185964, 1474189567, 1474193169, 1474196770, 1474196770, 1474200371, 1474200371, 1474203972, 1474203972, 1474203972, 1474203972, 1474203972, 1474207574, 1474211176, 1474211176, 1474211176, 1474211176, 1474218379, 1474218379, 1474229183, 1474232784, 1474236385, 1474239986, 1474239986, 1474247189, 1474247189, 1474250790, 1474250790, 1474254391, 1474254391, 1474254391, 1474257993, 1474257993, 1474260369, 1474260369, 1474263752, 1474263752, 1474270959, 1474270959, 1474274564, 1474278206, 1474281809, 1474281809, 1474281809, 1474281809, 1474289015, 1474289015, 1474292616, 1474292616, 1474296220, 1474299821, 1474303425, 1474303425, 1474307028, 1474310629, 1474314232, 1474314232, 1474321517, 1474325139, 1474328780, 1474328780, 1474328780, 1474332421, 1474332421, 1474336062, 1474339706, 1474339706, 1474339706, 1474343308, 1474343308, 1474346911, 1474350513, 1474350513, 1474350513, 1474354118, 1474354118, 1474357724, 1474357724, 1474361326, 1474364931, 1474370662, 1474374303, 1474377947, 1474377947, 1474377947, 1474381590, 1474385211, 1474392453, 1474392453, 1474406911, 1474406911, 1474406911, 1474406911, 1474410513, 1474414115, 1474414115, 1474421319, 1474424920, 1474424920, 1474424920, 1474424920, 1474424920, 1474424920, 1474424920, 1474428541, 1474428541, 1474435806, 1474446717, 1474450358, 1474450358, 1474457607, 1474457607, 1474457607, 1474457607, 1474457607, 1474461212, 1474464813, 1474464813, 1474464813, 1474464813, 1474468415, 1474472017, 1474475618, 1474475618, 1474482216, 1474482216, 1474485818, 1474486399, 1474499979, 1474499979, 1474499979, 1474499979, 1474499979, 1474499979, 1474503584, 1474503584, 1474514393, 1474517997, 1474517997, 1474517997, 1474521601, 1474521601, 1474521601, 1474521601, 1474525206, 1474528809, 1474528809, 1474536015, 1474536015, 1474536015, 1474545851, 1474546879, 1474550482, 1474554086, 1474554086, 1474554086, 1474564896, 1474564896, 1474569225, 1474572830, 1474572830, 1474576433, 1474576433, 1474580037, 1474580037, 1474583639, 1474583639, 1474590845, 1474594448, 1474598051, 1474601654, 1474601654, 1474605258, 1474608861, 1474608861, 1474612465, 1474616068, 1474616068, 1474619671, 1474619671, 1474623273, 1474623273, 1474623273, 1474623273, 1474630479, 1474630479, 1474634082, 1474634082, 1474634082, 1474637685, 1474644891, 1474644891, 1474648496, 1474652099, 1474652099, 1474655702, 1474659305, 1474666513, 1474670116, 1474673720, 1474683074, 1474686679, 1474686679, 1474686679, 1474686679, 1474686679, 1474686679, 1474686679, 1474686679, 1474690281, 1474693885, 1474697487, 1474701090, 1474701090, 1474704693, 1474704693, 1474704693, 1474708296, 1474708296, 1474711899, 1474715503, 1474719106, 1474719106, 1474722710, 1474726313, 1474726313, 1474726313, 1474726313, 1474729916, 1474729916, 1474733520, 1474733520, 1474733520, 1474737122, 1474740725, 1474744329, 1474744329, 1474744329, 1474747932, 1474747932, 1474751535, 1474762346, 1474762346, 1474762346, 1474769552, 1474769552, 1474769552, 1474773154, 1474773154, 1474776758, 1474780361, 1474783964, 1474787571, 1474793092, 1474793092, 1474796695, 1474796695, 1474796695, 1474800299, 1474800299, 1474800299, 1474803902, 1474807506, 1474811109, 1474811109, 1474821918, 1474823730, 1474823730, 1474823730, 1474827334, 1474830937, 1474834540, 1474834540, 1474834540, 1474838143, 1474841746, 1474841746, 1474845349, 1474845349, 1474848952, 1474856160, 1474859764, 1474863368, 1474866973, 1474870577, 1474870577, 1474877785, 1474877785, 1474884992, 1474888595, 1474895802, 1474895802, 1474897535, 1474901139, 1474901139, 1474901428, 1474918559, 1474923561, 1474923561, 1474930770, 1474934374, 1474934374, 1474937977, 1474937977, 1474947514, 1474947514, 1474951117, 1474951117, 1474954721, 1474954721, 1474954721, 1474958325, 1474961929, 1474961929, 1474961929};

  vector<double> ds4muTimes = {14090.6928, 14413.317, 15250.998, 15402.3958, 16672.4568, 20029.0779, 23566.6963, 25605.3344, 26847.4427, 27064.0812, 31530.6061, 33515.1272, 36659.7223, 37569.4994, 37835.5516, 38956.0274, 40769.6902, 41598.0485, 47319.1676, 51041.9251, 51872.3649, 55585.1139, 59602.4781, 60281.0847, 64423.0964, 65083.4762, 69143.3324, 71339.0597, 73536.4157, 75708.4268, 1378.07532, 7207.20368, 2971.69907, 875.62852, 1024.21635, 741.163976, 297.197919, 1040.1246, 1630.39812, 1272.46366, 2736.77085, 2344.70223, 1506.84099, 1918.87128, 2684.88964, 2774.29481, 3287.71035, 2786.16315, 3404.72909, 655.285321, 1830.27018, 2400.20898, 1195.79778, 2091.0218, 3044.18166, 3153.83269, 1629.82778, 253.675146, 3228.92992, 620.311386, 2728.45972, 3536.12599, 2737.89796, 3058.84947, 295.487015, 1242.48882, 2834.51018, 380.911355, 2072.76663, 3104.6503, 554.749486, 1642.00438, 320.353931, 2964.88073, 2985.72939, 135.423048, 1195.69035, 3497.52078, 2986.03585, 1634.63881, 3598.37369, 471.092773, 936.866675, 1490.64478, 2101.04842, 2411.68358, 212.458611, 910.519846, 2062.17392, 2714.52624, 615.613476, 1213.70019, 2634.84865, 2673.33795, 2852.60191, 3475.10193, 252.525339, 1182.99197, 1883.34671, 541.667566, 3381.46426, 427.207784, 1172.54153, 2133.7566, 1607.1951, 1051.62941, 511.674175, 1808.77499, 329.289519, 1160.84962, 1167.54084, 1348.61195, 1367.90291, 1936.64755, 574.209551, 1639.9613, 1663.00451, 1689.1927, 234.800713, 74.0867071, 921.111348, 1056.53962, 1361.26857, 1434.85846, 1573.05761, 327.921078, 1245.59692, 2033.54491, 2244.29929, 796.098042, 1987.37298, 2234.50722, 720.295647, 1616.66347, 2625.9623, 2686.026, 1217.10018, 2265.83328, 272.962801, 384.650976, 2013.91193, 274.485635, 2212.62332, 527.199539, 3539.7236, 4207.50307, 8996.71574, 9002.11609, 12082.3838, 16235.6427, 17196.7083, 23004.4167, 24492.4007, 24521.8547, 25035.9656, 25855.4043, 27063.3724, 27783.0041, 28494.2352, 28871.7982, 32273.8303, 32600.0639, 34574.2757, 36830.6766, 46588.4293, 54810.4209, 56117.2952, 59860.5362, 60631.2594, 64297.9289, 66088.3834, 68570.7223, 70983.4115, 75194.9297, 3216.85876, 3231.87321, 6553.36501, 8785.84176, 10990.5976, 11017.0195, 11557.2384, 13081.5608, 17882.5317, 18961.9851, 20634.0309, 21110.2022, 23236.2915, 23480.326, 24066.5031, 27837.852, 27838.0753, 28307.4749, 31580.4216, 33226.6454, 35335.2374, 35776.2715, 37436.1441, 37607.5225, 39782.1999, 42345.8143, 43724.4241, 44141.3471, 45615.2702, 47111.9116, 50773.8385, 58358.4873, 60909.3802, 748.599006, 25287.3202, 27485.329, 29558.571, 31923.1407, 37183.8349, 39070.6956, 39295.7597, 41915.0901, 42019.8839, 42909.4036, 44435.9346, 45847.8618, 48285.6046, 55100.2874, 55439.6979, 56769.7914, 58855.9005, 59100.5408, 66392.8939, 71364.007, 79144.4755, 84058.3949, 84140.3297, 87368.2246, 91476.8175, 92334.6522, 93896.1922, 94357.5711, 95688.9357, 96133.4997, 99517.2272, 101238.964, 102758.676, 105353.001, 106993.469, 107004.849, 108271.348, 112423.092, 115237.713, 115313.936, 115683.135, 118171.066, 121289.829, 123291.513, 125050.983, 130507.162, 132476.177, 137207.828, 137897.597, 140949.35, 141391.422, 142033.697, 147909.892, 151682.187, 153125.97, 154205.701, 157948.145, 158185.764, 158338.952, 162256.819, 163199.202, 169686.788, 171916.989, 175263.052, 175573.466, 176575.395, 182024.794, 184458.633, 185400.606, 185857.578, 186714.174, 186820.288, 189076.862, 200136.702, 200483.848, 201596.84, 204306.973, 205577.165, 208355.966, 208818.288, 209106.016, 213114.063, 215324.601, 215929.318, 217137.22, 220362.265, 220397.487, 220400.725, 228419.414, 229436.454, 231187.229, 231896.646, 234786.471, 238061.775, 239396.295, 241064.51, 248190.423, 249590.504, 250203.362, 251907.68, 253687.841, 254695.075, 260705.189, 261178.434, 261516.561, 262012.517, 262624.843, 263104.889, 264023.446, 265169.672, 267837.539, 268372.035, 272711.161, 274731.7, 275435.351, 277685.525, 285358.523, 286652.78, 287188.867, 288766.902, 290832.619, 297033.915, 299947.286, 305268.494, 305492.868, 311206.246, 311264.354, 314711.491, 316907.644, 317703.663, 323487.669, 330951.826, 334253.715, 337178.69, 339015.395, 339952.828, 341424.467, 344008.931, 379892.911, 387048.266, 389058.446, 390757.841, 392494.389, 393176.146, 393339.139, 395676.319, 396287.824, 401948.416, 414568.478, 417312.28, 420101.212, 420896.869, 422105.012, 424681.137, 425073.64, 2180.72953, 3656.70478, 4784.12084, 13233.2608, 13292.6107, 16094.0108, 16760.0279, 20289.9608, 23757.7789, 23803.7264, 26605, 27350.3428, 29130.1995, 29996.4127, 30082.0808, 30437.5977, 33308.0863, 33555.0909, 35587.9684, 36001.3024, 36486.1874, 38776.9334, 44699.7194, 44835.6971, 46036.5338, 49292.3695, 49299.0603, 52936.7235, 58683.9977, 66134.2875, 67844.9546, 68597.8095, 68612.8928, 71236.9293, 71834.5968, 75054.3767, 1011.35478, 1476.2924, 7860.43879, 10531.8408, 11825.026, 12044.5304, 18362.0784, 19447.9712, 19465.249, 21672.5045, 22105.5115, 28022.3541, 34078.1765, 34476.9525, 36853.1532, 37621.2525, 43575.5277, 983.435867, 2926.93122, 3596.99728, 8968.93053, 11268.8748, 11798.0519, 12737.3995, 17734.4201, 18115.8818, 20089.5031, 21511.1531, 25010.7949, 26638.411, 27717.677, 32014.6366, 32102.6929, 34937.5743, 41304.0822, 41823.1864, 45592.4044, 46732.9159, 46804.72, 47046.8851, 48128.249, 50292.4334, 51491.2152, 51606.6579, 52688.9315, 54726.1815, 56582.1201, 60135.6499, 60535.3772, 61122.1127, 61400.1635, 63379.4705, 66906.7571, 72627.045, 889.185668, 2666.32428, 6670.44985, 9154.78726, 10221.8827, 10421.5305, 12459.4083, 13627.3099, 6129.7199, 7627.30328, 10587.4779, 11231.9859, 12208.015, 12348.8636, 14930.3408, 21129.3886, 22923.2837, 23054.0347, 23643.2705, 25545.5089, 27714.9149, 28411.3223, 30948.2537, 39087.8456, 43029.4229, 50165.2737, 55713.681, 55840.5965, 61009.6109, 70344.7916, 76725.8992, 77537.9679, 81839.1159, 82411.8499, 86052.2298, 86786.853, 92264.9254, 93149.61, 93419.7588, 94582.4346, 97912.4786, 102090.093, 102835.751, 105929.925, 109409.997, 111172.556, 112090.867, 115825.927, 116513.927, 117671.259, 119405.152, 122688.679, 124049.746, 124168.929, 124403.703, 124840.612, 129290.37, 131500.189, 133139.13, 133815.899, 134663.246, 144839.522, 145268.571, 152279.436, 153122.128, 156154.992, 158399.842, 163228.097, 164634.287, 164667.359, 166555.491, 168998.047, 170321.858, 174357.617, 174389.31, 175925.322, 176556.971, 179735.574, 182302.925, 183481.085, 183621.91, 186148.002, 186428.567, 189674.058, 197124.573, 216396.066, 221122.918, 225715.905, 230439.701, 231607.547, 239216.286, 244552.647, 245427.262, 247431.361, 247916.486, 249059.361, 249797.249, 255171.809, 259888.088, 260530.796, 261089.659, 262758.846, 266012.749, 266959.124, 268386.3, 270999.824, 272288.7, 273908.168, 274186.376, 280968.129, 283426.479, 286160.172, 286592.929, 287628.782, 288094.797, 289474.979, 291834.009, 293513.726, 296142.44, 297223.749, 298474.634, 303048.754, 303152.949, 308646.086, 310960.821, 317195.502, 318022.959, 319284.085, 319590.912, 321876.17, 326394.429, 326671.054, 338764.166, 340912.089, 350946.465, 351486.977, 353196.759, 353380.591, 353806.507, 354615.955, 359127.575, 359547.298, 359583.144, 360512.843, 361585.54, 365948.04, 366652.534, 367590.444, 372429.669, 375528.296, 376700.049, 377876.8, 386138.714, 387761.363, 389813.167, 390594.882, 391401.966, 391510.987, 395182.566, 395503.668, 395622.321, 396070.496, 400905.713, 403673.679, 407479.371, 410994.174, 416563.052, 421498.413, 425675.041, 429176.559, 431220.524, 433659.931, 434103.555, 437039.963, 437749.418, 437990.209, 440745.611, 442384.135, 443723.162, 451436.57, 453404.24, 453408.752, 5957.1314, 9734.50089, 17505.8329, 25554.6169, 26862.2633, 26917.3341, 29704.244, 30223.2319, 31775.6891, 32968.5789, 34698.2774, 48299.4889, 49570.3775, 53735.893, 55032.8791, 58928.941, 59252.4392, 66076.0222, 66825.2194, 69622.1735, 70656.9829, 76492.2458, 78764.7077, 81591.9195, 81643.4614, 82774.9549, 82959.084, 87877.6469, 87929.3883, 89810.2636, 93411.1452, 98866.9578, 99533.8237, 102764.684, 103644.825, 2010.44933, 5056.25459, 9589.66064, 793.165382, 810.691732, 1344.13225, 1591.08005, 1808.56659, 8134.53605, 11324.0891, 13231.3444, 18045.3624, 18725.6973, 23570.1753, 23862.0912, 25695.9599, 30932.7204, 31854.0573, 32787.9364, 38610.547, 38661.3756, 43017.0665, 48964.3866, 49527.8106, 50605.4922, 52532.8357, 56698.9665, 56732.4126, 60111.0817, 63877.0332, 69770.8552, 71316.4802, 71529.4057, 73509.6777, 74725.7796, 77447.5342, 78386.1834, 78670.9484, 82238.3154, 85175.3594, 88698.9843, 89631.0652, 90984.015, 91704.8995, 93704.1515, 97234.8365, 102538.904, 103643.991, 108860.352, 113996.548, 116955.217, 121983.46, 122148.958, 124470.884, 128715.45, 128798.543, 131113.433, 131674.208, 131731.643, 132213.829, 132863.88, 135154.211, 137113.839, 138611.98, 138681.448, 138701.491, 145544.212, 147117.523, 156039.85, 158380.341, 163848.771, 165510.268, 167427.655, 173014.246, 174382.772, 178643.628, 179651.482, 180241.85, 180544.639, 180776.941, 183841.957, 185185.566, 187039.82, 187602.086, 191158.284, 192237.918, 198721.4, 199446.781, 202647.699, 203804.393, 207705.091, 208418.877, 209488.13, 210242.844, 217413.939, 217725.108, 218232.502, 219112.292, 223172.982, 225890.721, 231668.759, 232216.411, 232480.685, 236722.766, 241720.299, 242615.726, 247392.376, 250533.696, 254447.841, 256024.082, 256554.592, 258577.57, 260300.18, 264283.741, 265263.293, 265792.311, 266083.481, 269186.492, 272026.9, 275331.747, 277450.868, 278115.728, 278432.187, 280353.013, 280364.86, 284013.545, 286662.742, 290221.103, 290392.386, 298316.358, 302806.25, 305788.403, 305817.764, 306230.482, 308129.051, 312203.054, 319861.417, 320329.493, 332953.995, 333719.56, 333797.219, 335861.701, 336768.923, 339593.426, 340127.001, 347668.321, 350296.844, 350882.428, 351745.878, 352278.442, 352592.442, 353246.432, 353521.031, 354081.993, 356299.79, 363854.411, 373120.456, 376375.048, 379209.074, 383474.462, 384054.437, 384711.518, 384742.734, 385981.572, 387341.239, 390850.667, 391692.142, 392468.16, 393148.097, 395732.319, 398663.437, 402739.737, 403921.163, 409406.336, 410913.532, 411584.657, 414209.595, 4213.38465, 4250.08771, 6181.72695, 6882.01216, 7346.45605, 7359.40139, 8022.25136, 9688.22674, 21175.8124, 24748.3765, 25012.959, 25217.7753, 25826.0785, 26186.275, 27689.1228, 29053.3228, 32994.9583, 35354.5348, 35363.4794, 40636.2123, 41656.8115, 43163.2338, 50026.6913, 51561.6018, 57943.3351, 60457.7936, 61269.2751, 61270.6964, 69989.203, 71758.7005, 4960.37388, 5827.62031, 8506.13884, 9660.10574, 10010.0586, 12553.1336, 13966.5242, 18736.4258, 19321.9224, 23855.586, 29236.7892, 32994.4471, 36377.3921, 36667.7197, 37622.0765, 41489.91, 41740.4291, 47550.7681, 48851.7507, 49211.17, 52198.1637, 54150.4279, 56402.4396, 57855.1772, 57983.7338, 58269.6534, 63762.2712, 65330.6524, 67193.8806, 67855.4819, 69676.5147, 70144.8018, 77081.1166, 79116.1206, 81900.6988, 87194.2677, 87275.5425, 88857.4083, 93446.9199, 98819.7311, 105653.838, 108856.132, 117369.394, 118865.962, 119220.822, 120093.537, 120316.051, 120418.178, 121597.882, 121827.231, 121856.919, 122773.976, 129022.054, 129839.467, 134499.913, 136078.669, 139053.429, 139244.252, 139991.432, 140491.866, 141409.258, 144933.972, 149006.259, 151571.658, 152734.641, 156992.153, 158930.801, 159281.572, 160581.256, 162066.287, 165041.475, 165195.269, 166366.88, 166551.765, 168918.631, 172241.312, 174958.842, 176930.915, 177852.131, 178779.746, 181138.299, 182712.584, 186314.497, 194664.302, 194707.169, 195931.235, 202781.885, 205266.722, 205327.084, 206660.968, 207087.529, 209727.306, 215351.299, 219138.043, 221323.121, 226105.317, 228371.323, 229976.271, 230235.656, 232009.172, 232676.023, 234146.207, 235049.85, 236787.306, 243068.678, 244113.225, 245169.107, 254988.309, 1571.72449, 1733.77469, 2589.89207, 7046.80534, 9502.36281, 11535.1521, 11810.5306, 12007.4167, 16769.3459, 18786.5677, 18898.754, 22282.9659, 23479.9755, 28444.2516, 33676.3068, 36913.3072, 40211.1729, 46048.2468, 47109.7725, 50402.6678, 55769.8034, 56853.8822, 63507.5313, 68113.0699, 72448.5872, 73207.5436, 698.161396, 3970.17528, 4014.75755, 7443.40891, 433.676892, 4316.17489, 7103.46332, 12228.521, 15051.6557, 15464.0524, 18881.0968, 20499.5458, 30423.1152, 30964.7085, 31526.0525, 31529.2395, 36179.4738, 37332.0493, 38234.6411, 41761.8318, 43084.877, 43911.7165, 44925.0957};

  vector<double> ds4muUncert = {1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41517957, 1.41517957, 1.41464767, 1.41469465, 1.4151331, 1.41454142, 1.41682765, 1.41471324, 1.41471324, 1.41531558, 1.41743307, 1.41743307, 1.41508561, 1.41495329, 1.41495329, 1.41422639, 1.4149068, 1.41421404, 1.41436032, 1.41430506, 1.41453006, 1.4148291, 1.4148291, 1.41428475, 1.41449095, 1.41449095, 1.41701902, 1.41701902, 1.4143248, 1.4143248, 1.4146146, 1.41480289, 1.41425027, 1.41521071, 1.41521071, 1.41521071, 1.41427577, 1.41427577, 1.41448173, 1.41448173, 1.42187277, 1.4143046, 1.4143046, 1.4143046, 1.41468114, 1.41468114, 1.41455951, 1.41477975, 1.41477975, 1.4147421, 1.4147421, 1.41421357, 1.41421357, 1.41476452, 1.41719631, 1.41719631, 1.41719631, 1.41453123, 1.4142218, 1.4142218, 1.41463124, 1.41463124, 1.41463124, 1.41463124, 1.41454165, 1.41454165, 1.41454165, 1.41454165, 1.41454165, 1.41663212, 1.41663212, 1.41423632, 1.41524809, 1.41436202, 1.41490808, 1.41490808, 1.41490808, 1.41490808, 1.41450789, 1.41437994, 1.41541461, 1.41541461, 1.41690776, 1.41690776, 1.41690776, 1.41433257, 1.41449896, 1.41449896, 1.41716042, 1.41716042, 1.41716042, 1.41716042, 1.41650973, 1.41472528, 1.41423109, 1.41423109, 1.41423109, 1.41423109, 1.41423109, 1.41429451, 1.41429451, 1.41429451, 1.41429451, 1.41784027, 1.41784027, 1.41422206, 1.4163161, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41473689, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41781855, 1.4158292, 1.41587682, 1.41587682, 1.41691982, 1.41691982, 1.41691982, 1.41433906, 1.41433906, 1.41433906, 1.41508564, 1.41508564, 1.41954927, 1.41424952, 1.41424952, 1.41424952, 1.4142725, 1.4142725, 1.41441754, 1.4323748, 1.41462717, 1.41437726, 1.41437726, 1.41465541, 1.41572302, 1.41572302, 1.41572302, 1.4155392, 1.4155392, 1.4155392, 1.4215984, 1.4215984, 1.42073368, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421367, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41457954, 1.41457954, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41600257, 1.41600257, 1.41421357, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41661264, 1.41828786, 1.41828786, 1.41545, 1.41545, 1.41545, 1.41445022, 1.41539197, 1.41539197, 1.41771812, 1.41771812, 1.41421356, 1.41421356, 1.4148451, 1.41500724, 1.41500724, 1.41422375, 1.41494702, 1.41494702, 1.41482395, 1.41482395, 1.41482395, 1.41482395, 1.41482395, 1.41570933, 1.41570933, 1.41570933, 1.41497115, 1.41497115, 1.41738401, 1.41779489, 1.41779489, 1.41779489, 1.41779489, 1.42031221, 1.4165463, 1.41450298, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41425798, 1.41425798, 1.41425798, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421357, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41422257, 1.41422257, 1.41422257, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421379, 1.41421379, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41423386, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421357, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41468949, 1.41468949, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41552494, 1.41454081, 1.41862425, 1.41862425, 1.42875259, 1.4248037, 1.4248037, 1.41426335, 1.41426335, 1.41426335, 1.41426335, 1.42375687, 1.42375687, 1.42375687, 1.42375687, 1.41429627, 1.41429627, 1.41749124, 1.41710311, 1.42061097, 1.41424724, 1.41464421, 1.41424422, 1.41424422, 1.4193972, 1.4193972, 1.41457282, 1.41457282, 1.41457282, 1.41474387, 1.41474387, 1.4164222, 1.4145351, 1.4145351, 1.4145351, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421357, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41437266, 1.41437266, 1.41437266, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41443214, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41424129, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41438208, 1.41438208, 1.41438208, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421759, 1.41421759, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.4143305, 1.4143305, 1.4143305, 1.4143305, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41429944, 1.41429944, 1.41429944, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41426771, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.41421356, 1.4142223, 1.41421356, 1.41421356, 1.41421356};

  // Copy vectors into the ones used by skim_mjd_data
  muRuns = ds4muRuns;
  muRunTStarts = ds4muRunTStarts;
  muTimes = ds4muTimes;
  muTypes = ds4muTypes;
  muUncert = ds4muUncert;
}


void LoadLNFillTimes1(vector<double>& lnFillTimes1, int dsNum)
{
  if (dsNum == 0)
    lnFillTimes1 = {
      1435720848, 1435721208, 1435870160, 1436020533, 1436168622, 1436316362, 1436463827, 1436464128, 1436614832,
      1436759402, 1436908966, 1437058884, 1437060627, 1437061093, 1437204895, 1437205196, 1437350621, 1437350981,
      1437638022, 1437638383, 1437781652, 1437782012, 1437926383, 1438070819, 1438121812, 1438212611, 1438352837,
      1438496004, 1438496305, 1438639835, 1438640196, 1438782282, 1438782583, 1438932169, 1439080850, 1439081151,
      1439226624, 1439226984, 1439371591, 1439371951, 1439514291, 1439657247, 1439657607, 1439801649, 1439802009,
      1439944622, 1440080091, 1440192295, 1440335863, 1440477294, 1440618411, 1440618712, 1440759782, 1440760142,
      1440902658, 1440902959, 1441046730, 1441187019, 1441187320, 1441325878, 1441326239, 1441462000, 1441462301,
      1441600116, 1441600417, 1441741779, 1441742080, 1441883940, 1441884241, 1442027368, 1442027669, 1442169713,
      1442170094, 1442312599, 1442312900, 1442453920, 1442595578, 1442595879, 1442737259, 1442737560, 1442879000,
      1442879301
    };
  else if (dsNum == 1)
    lnFillTimes1 = {
      1452655867, 1452791415, 1452791716, 1453541032, 1453541393, 1453670314, 1453670675, 1453800137, 1453800498,
      1453929779, 1453937178, 1453998125, 1453998906, 1454000591, 1454002035, 1454002456, 1454002757, 1454014971,
      1454107981, 1454108282, 1454219392, 1454219753, 1454332307, 1454332608, 1454332909, 1454447212, 1454559953,
      1454560314, 1454560615, 1454679496, 1454769079, 1454882301, 1454882662, 1454946492, 1454951907, 1454952930,
      1454954012, 1454955958, 1455225161, 1455225462, 1455228289, 1455440690, 1455568585, 1455568886, 1455696789,
      1455697090, 1455822149, 1455822450, 1455952573, 1456082166, 1456082467, 1456206057, 1456206358, 1456333236,
      1456460237, 1456460538, 1456588495, 1456588796, 1456717776, 1456718077, 1456846882, 1456943983, 1456944465,
      1456981934, 1457110918, 1457111219, 1457238098, 1457238399, 1457365179, 1457491997, 1457492298, 1457619662,
      1457619963, 1457747884, 1457874684, 1458001143, 1458001444, 1458130495, 1458130796, 1458259402, 1458259703,
      1458387930, 1458388231, 1458515657, 1458639685, 1458640046, 1458767518, 1458767879, 1458896260, 1458896561,
      1459023862, 1459150863, 1459151164, 1459275989, 1459276290, 1459402548, 1459402849, 1459529663, 1459530023,
      1459654930, 1459655231, 1459785212, 1459912507, 1459912808, 1460042708, 1460043009, 1460169429, 1460169730,
      1460297779, 1460298080, 1460426527, 1460426828, 1460552742, 1460678641, 1460808916, 1460809217, 1460939150,
      1461064619, 1461064920, 1461189868, 1461318559, 1461318860, 1461443967, 1461444268, 1461569658, 1461569959,
      1461695992, 1461824752, 1461825053, 1461952713, 1461953014, 1462258909, 1462314666, 1462371538, 1462426019,
      1462462316, 1462462617, 1462462918, 1462463219, 1462588708, 1462715136, 1462840823, 1462841124, 1462966744,
      1462967045, 1463093301, 1463093602, 1463220332, 1463220636, 1463346237, 1463346558, 1463472892, 1463473193,
      1463599111, 1463599412, 1463694217
    };
  else if(dsNum == 2)
    lnFillTimes1 = {
      1465002657, 1465002958, 1465128881, 1465129182, 1465254829, 1465255130, 1465379929, 1465380230, 1465501071,
      1465593608, 1465593929, 1465722641, 1465723002, 1466024056, 1466078698, 1466095128, 1466095429, 1466095731,
      1466221253, 1466221573, 1466345919, 1466472151, 1466472452, 1466596048, 1466596349, 1466719933, 1466720234,
      1466804031, 1466930672, 1466930973, 1467051375, 1467178832, 1467179136, 1467302530, 1467302831, 1467426540,
      1467426841, 1467550116, 1467550477, 1467674708, 1467675009, 1467802799, 1467803101, 1467929293, 1467929594,
      1468057309, 1468057610, 1468180299, 1468180600
    };
  else if(dsNum == 3)
    lnFillTimes1 = {
      1472268007, 1472404916, 1472545253, 1472545554, 1472683456, 1472683757, 1472822134, 1472961379, 1473096880,
      1473097181, 1473236517, 1473236818, 1473369324, 1473369625, 1473510316, 1473635684, 1473635985, 1473771858,
      1473772159, 1473909355, 1473909657, 1474045268, 1474182801, 1474183102, 1474319605, 1474319906, 1474457662,
      1474457964, 1474569273, 1474705001, 1474705302, 1474842466
    };
  else if (dsNum == 5)
    lnFillTimes1 = {
      1476453399, 1476453700, 1476590095, 1476590396, 1476725368, 1476725669, 1476860943, 1476988923, 1476989224,
      1477126392, 1477126693, 1477263085, 1477398722, 1477399042, 1477535486, 1477535787, 1477673729, 1477810060,
      1477943283, 1478078740, 1478079044, 1478213569, 1478349968, 1478350270, 1478485711, 1478486012, 1478635187,
      1478635488, 1478773172, 1478773473, 1478908905, 1479037406, 1479037707, 1479169196, 1479169497, 1479304674,
      1479304975, 1479418735, 1479553573, 1479553876, 1479685756, 1479686057, 1479816678, 1479816979, 1479949240,
      1479949541, 1480084329, 1480084630, 1480216536, 1480477171, 1480477472, 1480610478, 1480744620, 1480874159,
      1480874460, 1481003415, 1481136272, 1481270528, 1481270834, 1481321467, 1481457733, 1481458036, 1481591390,
      1481591691, 1481722238, 1481722539, 1481835467, 1481967769, 1482099573, 1482099874, 1482230832, 1482363183,
      1482363484, 1482490692, 1482490995, 1482621593, 1482621953, 1482751715, 1482883864, 1482884165, 1483015618,
      1483015919, 1483142973, 1483143274, 1483273444, 1483273745, 1483406229, 1483534897, 1483535198, 1483737070,
      1483868828, 1483869149, 1483994327, 1483994628, 1484126706, 1484127007, 1484257208, 1484257509, 1484391758,
      1484392179, 1484526418, 1484526719, 1484690034, 1484690337, 1484823414, 1484823715, 1484870562, 1484943990,
      1485076303, 1485076605, 1485204746, 1485205107, 1485338033, 1485338334, 1485465730, 1485466031, 1485599009,
      1485599310, 1485728280, 1485728641, 1485852829, 1485853130, 1485984256, 1485984557, 1486111924, 1486153947,
      1486359948, 1486360249, 1486494611, 1486494912, 1486625386, 1486625687, 1486759864, 1486760165, 1486898541,
      1486898842, 1487029529, 1487029889, 1487155174, 1487155534, 1487290720, 1487291080, 1487427167, 1487427525,
      1487561271, 1487561631, 1487694477, 1487828422, 1487828723, 1487864401, 1488002374, 1488002675, 1488129971,
      1488130273, 1488264928, 1488265229, 1488395270, 1488395571, 1488527853, 1488528154, 1488653319, 1488653620,
      1488781734, 1488782037, 1488913613, 1488913914, 1489046971, 1489047332, 1489048234, 1489048898, 1489049439,
      1489050041, 1489050462, 1489071062, 1489072269, 1489072810, 1489297040, 1489297341, 1489430768, 1489431069,
      1489560237, 1489560538, 1489690781, 1489691082
    };
}


void LoadLNFillTimes2(vector<double>& lnFillTimes2, int dsNum)
{
  if (dsNum == 4)
    lnFillTimes2 = {
      1472169706, 1472283139, 1472283440, 1472392397, 1472392698, 1472508671, 1472509032, 1472626749, 1472627052,
      1472749055, 1472750741, 1472848201, 1472848502, 1472959270, 1472959571, 1473069251, 1473069554, 1473180721,
      1473181022, 1473291137, 1473291438, 1473369625, 1473485389, 1473485730, 1473594355, 1473594656, 1473702993,
      1473703294, 1473815615, 1473815919, 1473926807, 1473927167, 1474040572, 1474040873, 1474150140, 1474150441,
      1474260642, 1474261003, 1474370902, 1474371262, 1474482449, 1474482750, 1474569695, 1474679736, 1474680037,
      1474789636, 1474789937, 1474901605, 1474901906
    };
  else if (dsNum == 5)
    lnFillTimes2 = {
      1476438165, 1476438466, 1476474106, 1476589193, 1476589554, 1476700835, 1476701136, 1476812498, 1476812799,
      1476927295, 1476927596, 1476989828, 1477055763, 1477056064, 1477123926, 1477192974, 1477193275, 1477261802,
      1477262103, 1477325805, 1477326166, 1477459278, 1477459579, 1477686549, 1477686850, 1477800402, 1477800703,
      1477911061, 1477911362, 1478027274, 1478027577, 1478144219, 1478144522, 1478256013, 1478256314, 1478376006,
      1478376366, 1478489342, 1478489645, 1478604014, 1478604315, 1478712990, 1478713291, 1478822383, 1478822684,
      1478932948, 1478933249, 1479043427, 1479043728, 1479155203, 1479155504, 1479269432, 1479269733, 1479385115,
      1479385436, 1479420059, 1479530408, 1479530709, 1479644357, 1479644658, 1479758177, 1479758478, 1479875036,
      1479875337, 1479990557, 1479990861, 1480104123, 1480104424, 1480217981, 1480218302, 1480325906, 1480326227,
      1480440487, 1480440848, 1480550916, 1480551217, 1480619639, 1480734801, 1480735104, 1480842825, 1480843126,
      1480952106, 1480952407, 1481067058, 1481067419, 1481178211, 1481178514, 1481288176, 1481288477, 1481321507,
      1481435047, 1481435368, 1481551179, 1481551480, 1481665221, 1481665522, 1481780658, 1481780959, 1481836309,
      1481945846, 1481946147, 1482060754, 1482061075, 1482174422, 1482174723, 1482288906, 1482289207, 1482419766,
      1482420107, 1482533028, 1482533329, 1482647683, 1482648004, 1482761763, 1482813843, 1482814144, 1482928158,
      1482928479, 1483041177, 1483041480, 1483150257, 1483150618, 1483263614, 1483263915, 1483375931, 1483376235,
      1483486995, 1483487296, 1483596540, 1483596842, 1483708518, 1483708819, 1483722724, 1483735806, 1483738818,
      1483844443, 1483844803, 1483955996, 1483956297, 1484000769, 1484069674, 1484070396, 1484153420, 1484153721,
      1484240112, 1484325801, 1484326106, 1484438136, 1484438437, 1484549308, 1484549609, 1484681327, 1484681668,
      1484793262, 1484793583, 1484904014, 1484904315, 1485013552, 1485013853, 1485124164, 1485124467, 1485232620,
      1485232921, 1485343512, 1485343813, 1485454351, 1485454652, 1485566625, 1485566926, 1485677147, 1485677448,
      1485787152, 1485787453, 1485896831, 1485897132, 1486007973, 1486008274, 1486116439, 1486116799, 1486154148,
      1486263023, 1486263343, 1486373311, 1486373612, 1486485400, 1486485761, 1486597618, 1486597919, 1486655179,
      1486765820, 1486766124, 1486876700, 1486877001, 1486991129, 1486991432, 1487104592, 1487104952, 1487221958,
      1487222321, 1487334442, 1487334822, 1487446410, 1487446787, 1487557663, 1487558031, 1487669815, 1487670155,
      1487780781, 1487781431, 1487862530, 1487862831, 1487976474, 1487976775, 1488091110, 1488091470, 1488204162,
      1488204483, 1488317724, 1488318025, 1488429357, 1488429659, 1488543167, 1488543468, 1488657835, 1488658136,
      1488770654, 1488770957, 1488882113, 1488882414, 1488994865, 1488995166, 1489071062, 1489104062, 1489104423,
      1489216551, 1489326545, 1489326846, 1489440424, 1489440725, 1489551743, 1489552044, 1489662244, 1489662545
    };
}
